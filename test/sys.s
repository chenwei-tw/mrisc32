; =============================================================================
; == System library
; =============================================================================

; -----------------------------------------------------------------------------
; exit(int exit_code)
; -----------------------------------------------------------------------------
_exit:
  ldi    r16, 0x0000
  ldihi  r16, 0xffff
  jmp    r16


; -----------------------------------------------------------------------------
; putc(int c)
; -----------------------------------------------------------------------------
_putc:
  ldi    r16, 0x0004
  ldihi  r16, 0xffff
  jmp    r16


; -----------------------------------------------------------------------------
; puts(char* s)
; -----------------------------------------------------------------------------
_puts:
  mov    r14, lr

  mov    r12, r4
  ldi    r13, 0
__puts_loop:
  ldx.b  r4, r12, r13
  andi   r4, r4, 255
  addi   r13, r13, 1
  beq    r4, __puts_eos
  bsr    _putc
  bra    __puts_loop

__puts_eos:
  ldi    r4, 10
  bsr    _putc

  mov    lr, r14
  rts

